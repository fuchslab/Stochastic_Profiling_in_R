mtext(expression(mu[2]), side = 2, line = 3, las = 1, cex = 1.5)
## sigma
vioplot::vioplot(list(sigma_set1$sigma[index], sigma_set5$sigma[index]), names = c("",
""), col = c("#89BBBF", "lightgrey"), at = c(1, 3), axes = F, ylab = "",
xlab = "", pch = 20, main = "", yaxt = "n")
lines(c(-1, 3.66666), c(-0.1, 0.6), lw = 2, lty = 2, col = "#FF7F00")
axis(side = 2, cex.axis = 1.3, las = 1)
axis(side = 1, at = c(1, 3), c(expression(paste(sigma, " = 0.2")), expression(paste(sigma,
" = 0.5"))), cex.axis = 1.1, tick = FALSE)
mtext(expression(sigma), side = 2, line = 3, las = 1, cex = 1.5)
title(paste0("Parameter estimates for ", cellnumber), outer = TRUE, cex.main = 2)
dev.off()
}
setwd("D:/Users/lisa.amrhein/ICB/NeueArbeit/Stochastic_Profiling_in_R/UncertaintyCellnumber/Uncertainty_10")
n_uncertain <- c(5, 6, 7, 8, 9, 11, 12, 13, 14, 15)
# Set1 and parameters
whichSet <- "Set1"
p <- matrix(rep(0, 11 * 1000), nrow = 11)
mu_1 <- matrix(rep(0, 11 * 1000), nrow = 11)
mu_2 <- matrix(rep(0, 11 * 1000), nrow = 11)
sigma <- matrix(rep(0, 11 * 1000), nrow = 11)
for (n in n_uncertain) {
Var_name <- paste(whichSet, "10", sep = "_")
Var_name2 <- paste(Var_name, "fitting", n, sep = "_")
Var_rda <- paste(Var_name2, "rda", sep = ".")
load(file = Var_rda)
i <- n - 4
for (j in 1:1000) {
p[i, j] <- result_fit_uncertain_list[[j]]$mle[1]
mu_1[i, j] <- result_fit_uncertain_list[[j]]$mle[2]
mu_2[i, j] <- result_fit_uncertain_list[[j]]$mle[3]
sigma[i, j] <- result_fit_uncertain_list[[j]]$mle[4]
}
}
# p-plots setwd('..')
load("SimulationStudies/2_FitDatasets/Set1/Set1_10_fitting.rda")
for (j in 1:1000) {
p[6, j] <- result_fit_list[[j]]$mle[1]
mu_1[6, j] <- result_fit_list[[j]]$mle[2]
mu_2[6, j] <- result_fit_list[[j]]$mle[3]
sigma[6, j] <- result_fit_list[[j]]$mle[4]
}
# Preparation done use colors FF7F00 #true -> orange color
# Create Plots True values
p_true <- c(0.2, 0.8)
mu_true <- c(2, 0)
sigma_true <- 0.2
load("D:/Users/lisa.amrhein/ICB/NeueArbeit/Stochastic_Profiling_in_R/SimulationStudies/2_FitDatasets/Set1/Set1_10_fitting.rda")
for (j in 1:1000) {
p[6, j] <- result_fit_list[[j]]$mle[1]
mu_1[6, j] <- result_fit_list[[j]]$mle[2]
mu_2[6, j] <- result_fit_list[[j]]$mle[3]
sigma[6, j] <- result_fit_list[[j]]$mle[4]
}
# Create Plots True values
p_true <- c(0.2, 0.8)
mu_true <- c(2, 0)
sigma_true <- 0.2
p_all_3 <- matrix(c(matrixStats::rowMins(p), matrixStats::rowMeans2(p), matrixStats::rowMaxs(p)),
nrow = 11, ncol = 3)
mu1_all_3 <- matrix(c(matrixStats::rowMins(mu_1), matrixStats::rowMeans2(mu_1), matrixStats::rowMaxs(mu_1)),
nrow = 11, ncol = 3)
mu2_all_3 <- matrix(c(matrixStats::rowMins(mu_2), matrixStats::rowMeans2(mu_2), matrixStats::rowMaxs(mu_2)),
nrow = 11, ncol = 3)
sigma_all_3 <- matrix(c(matrixStats::rowMins(sigma), matrixStats::rowMeans2(sigma),
matrixStats::rowMaxs(sigma)), nrow = 11, ncol = 3)
p_all_3 <- matrix(c(matrixStats::rowMins(p), matrixStats::rowMeans2(p), matrixStats::rowMaxs(p)),
nrow = 11, ncol = 3)
mu1_all_3 <- matrix(c(matrixStats::rowMins(mu_1), matrixStats::rowMeans2(mu_1), matrixStats::rowMaxs(mu_1)),
nrow = 11, ncol = 3)
mu2_all_3 <- matrix(c(matrixStats::rowMins(mu_2), matrixStats::rowMeans2(mu_2), matrixStats::rowMaxs(mu_2)),
nrow = 11, ncol = 3)
sigma_all_3 <- matrix(c(matrixStats::rowMins(sigma), matrixStats::rowMeans2(sigma),
matrixStats::rowMaxs(sigma)), nrow = 11, ncol = 3)
?matrixStats::rowMeans2
0.025*1000
?quantile
quantile(p_all_3[1,],probs=(0.25,0.975))
quantile(p_all_3[1,],probs=(0.025,0.975))
quantile(p_all_3[1,],probs=c(0.025,0.975))
quantile(p_all_3[1,],probs=c(0.0250.5,,0.975))
quantile(p_all_3[1,],probs=c(0.025,0.5,,0.975))
quantile(p_all_3[1,],probs=c(0.025,0.5,0.975))
quantile(p_all_3[1,])
?apply
Output<-lapply( p,1,quantile,probs=c(0.025,0.5,0.975))
?lapply(list, function)
?lapply
Output<-apply( p,1,quantile,probs=c(0.025,0.5,0.975))
Output<-apply( p,2,quantile,probs=c(0.025,0.5,0.975))
dim(p)
View(Output)
mu1_all_3<-apply(mu_1,2,quantile,probs=c(0.025,0.5,0.975))
mu2_all_3<-apply(mu_2,2,quantile,probs=c(0.025,0.5,0.975))
sigma_all_3<-apply(sigma,2,quantile,probs=c(0.025,0.5,0.975))
EnvStats::errorBar(x = 5:15, y = p_all_3[, 2], lower = p_all_3[, 1], upper = p_all_3[,
3], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
ylim = c(0, 1), yaxt = "n", xaxt = "n", cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(0, 1, by = 0.2), seq(0, 1, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = p_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(p), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = mu1_all_3[, 2], lower = mu1_all_3[, 1], upper = mu1_all_3[,
3], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 3), cex.axis = 1.3, cex.lab = 1.7)
p_all_3<-apply(p,2,quantile,probs=c(0.025,0.5,0.975))
p_all_3<-apply(p,1,quantile,probs=c(0.025,0.5,0.975))
mu1_all_3<-apply(mu_1,1,quantile,probs=c(0.025,0.5,0.975))
mu2_all_3<-apply(mu_2,1,quantile,probs=c(0.025,0.5,0.975))
sigma_all_3<-apply(sigma,1,quantile,probs=c(0.025,0.5,0.975))
EnvStats::errorBar(x = 5:15, y = p_all_3[, 2], lower = p_all_3[, 1], upper = p_all_3[,
3], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
ylim = c(0, 1), yaxt = "n", xaxt = "n", cex.axis = 1.3, cex.lab = 1.7)
p_all_3<-apply(p,1,quantile,probs=c(0.025,0.5,0.975))
p_all_3<-apply(p,2,quantile,probs=c(0.025,0.5,0.975))
p_all_3<-apply(p,1,quantile,probs=c(0.025,0.5,0.975))
length(5:15)
EnvStats::errorBar(x = 5:15, y = p_all_3[, 2], lower = p_all_3[, 1], upper = p_all_3[,
3], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
ylim = c(0, 1), yaxt = "n", xaxt = "n", cex.axis = 1.3, cex.lab = 1.7)
p_all_3[, 2]
EnvStats::errorBar(x = 5:15, y = p_all_3[ 2,], lower = p_all_3[1,], upper = p_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
ylim = c(0, 1), yaxt = "n", xaxt = "n", cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(0, 1, by = 0.2), seq(0, 1, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = p_true[1], lw = 2, lty = 2, col = "#FF7F00")
EnvStats::errorBar(x = 5:15, y = mu1_all_3[ 2,], lower = mu1_all_3[ 1,], upper = mu1_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 3), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(0, 3, by = 1), seq(0, 3, by = 1), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[1]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
legend(x = 12, y = 4.5, legend = "true value", lw = 2, lty = 2, col = "#FF7F00",
bty = "n", xpd = NA, cex = 1.3)
EnvStats::errorBar(x = 5:15, y = mu2_all_3[ 2,], lower = mu2_all_3[1,], upper = mu2_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(-40, 10), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(-40, 10, by = 10), seq(-40, 10, by = 10), cex.axis = 1.3,
tick = TRUE, las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[2], lw = 2, lty = 2, col = "#FF7F00")
EnvStats::errorBar(x = 5:15, y = mu2_all_3[ 2,], lower = mu2_all_3[1,], upper = mu2_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(-40, 10, by = 10), seq(-40, 10, by = 10), cex.axis = 1.3,
tick = TRUE, las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[2], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[2]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
axis(side = 2, at = seq(-1, 1, by = 1), seq(-40, 10, by = 10), cex.axis = 1.3,
tick = TRUE, las = 1)
axis(side = 2, at = seq(-1, 1, by = 1), seq(-1, 1, by = 1), cex.axis = 1.3,
tick = TRUE, las = 1)
axis(side = 2, at = seq(-2, 1, by = 1), seq(-2, 1, by = 1), cex.axis = 1.3,
tick = TRUE, las = 1)
EnvStats::errorBar(x = 5:15, y = mu2_all_3[ 2,], lower = mu2_all_3[1,], upper = mu2_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(-2.5,1.2), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(-2.5, 1.5, by = 0.5), seq(-2.5, 1.5, by = 0.5), cex.axis = 1.3,
tick = TRUE, las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[2], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[2]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = sigma_all_3[ 2,], lower = sigma_all_3[1,], upper = sigma_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 1), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
axis(side = 2, at = seq(0, 1, by = 0.2), seq(0, 1, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
EnvStats::errorBar(x = 5:15, y = sigma_all_3[ 2,], lower = sigma_all_3[1,], upper = sigma_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 0.5), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
axis(side = 2, at = seq(0, 0.5, by = 0.25), seq(0, 0.5, by = 0.25), cex.axis = 1.3, tick = TRUE,
las = 1)
abline(h = sigma_true[1], lw = 2, lty = 2, col = "#FF7F00")
EnvStats::errorBar(x = 5:15, y = sigma_all_3[ 2,], lower = sigma_all_3[1,], upper = sigma_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 0.4), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
axis(side = 2, at = seq(0, 0.4, by = 0.2), seq(0, 0.4, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
abline(h = sigma_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(sigma), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
pdf(paste0("Uncertainty_10.pdf"), width = 12, height = 6)
par(mfrow = c(2, 2), oma = c(2, 1, 2, 1), mar = c(4, 5, 3, 0), mgp = c(3, 1, 0),
bty = "n")
EnvStats::errorBar(x = 5:15, y = p_all_3[ 2,], lower = p_all_3[1,], upper = p_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
ylim = c(0, 1), yaxt = "n", xaxt = "n", cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(0, 1, by = 0.2), seq(0, 1, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = p_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(p), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = mu1_all_3[ 2,], lower = mu1_all_3[ 1,], upper = mu1_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 3), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(0, 3, by = 1), seq(0, 3, by = 1), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[1]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
legend(x = 12, y = 4.5, legend = "true value", lw = 2, lty = 2, col = "#FF7F00",
bty = "n", xpd = NA, cex = 1.3)
EnvStats::errorBar(x = 5:15, y = mu2_all_3[ 2,], lower = mu2_all_3[1,], upper = mu2_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(-2.5,1.2), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(-2.5, 1.5, by = 0.5), seq(-2.5, 1.5, by = 0.5), cex.axis = 1.3,
tick = TRUE, las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[2], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[2]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = sigma_all_3[ 2,], lower = sigma_all_3[1,], upper = sigma_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 0.4), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
axis(side = 2, at = seq(0, 0.4, by = 0.2), seq(0, 0.4, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
abline(h = sigma_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(sigma), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
dev.off()
EnvStats::errorBar(x = 5:15, y = mu2_all_3[ 2,], lower = mu2_all_3[1,], upper = mu2_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(-2.5,1.5), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(-2, 1, by = 1), seq(-2, 1, by = 1), cex.axis = 1.3,
tick = TRUE, las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[2], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[2]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = sigma_all_3[ 2,], lower = sigma_all_3[1,], upper = sigma_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 0.4), cex.axis = 1.3, cex.lab = 1.7)
pdf(paste0("Uncertainty_10.pdf"), width = 8, height = 6)
par(mfrow = c(2, 2), oma = c(2, 1, 2, 1), mar = c(4, 5, 3, 0), mgp = c(3, 1, 0),
bty = "n")
EnvStats::errorBar(x = 5:15, y = p_all_3[ 2,], lower = p_all_3[1,], upper = p_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
ylim = c(0, 1), yaxt = "n", xaxt = "n", cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(0, 1, by = 0.2), seq(0, 1, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = p_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(p), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = mu1_all_3[ 2,], lower = mu1_all_3[ 1,], upper = mu1_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 3), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(0, 3, by = 1), seq(0, 3, by = 1), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[1]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
legend(x = 12, y = 4.5, legend = "true value", lw = 2, lty = 2, col = "#FF7F00",
bty = "n", xpd = NA, cex = 1.3)
EnvStats::errorBar(x = 5:15, y = mu2_all_3[ 2,], lower = mu2_all_3[1,], upper = mu2_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(-2.5,1.5), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(-2, 1, by = 1), seq(-2, 1, by = 1), cex.axis = 1.3,
tick = TRUE, las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[2], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[2]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = sigma_all_3[ 2,], lower = sigma_all_3[1,], upper = sigma_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 0.4), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
axis(side = 2, at = seq(0, 0.4, by = 0.2), seq(0, 0.4, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
abline(h = sigma_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(sigma), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
dev.off()
par(mfrow = c(2, 2), oma = c(2, 1, 2, 1), mar = c(4, 5, 3, 0), mgp = c(3, 1, 0),
bty = "n")
EnvStats::errorBar(x = 5:15, y = p_all_3[ 2,], lower = p_all_3[1,], upper = p_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
ylim = c(0, 1), yaxt = "n", xaxt = "n", cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(0, 1, by = 0.2), seq(0, 1, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = p_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(p), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = mu1_all_3[ 2,], lower = mu1_all_3[ 1,], upper = mu1_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 3), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(0, 3, by = 1), seq(0, 3, by = 1), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[1]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
legend(x = 10, y = 4.5, legend = "true value", lw = 2, lty = 2, col = "#FF7F00",
bty = "n", xpd = NA, cex = 1.3)
EnvStats::errorBar(x = 5:15, y = mu2_all_3[ 2,], lower = mu2_all_3[1,], upper = mu2_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(-2.5,1.5), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(-2, 1, by = 1), seq(-2, 1, by = 1), cex.axis = 1.3,
tick = TRUE, las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[2], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[2]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = sigma_all_3[ 2,], lower = sigma_all_3[1,], upper = sigma_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 0.4), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
axis(side = 2, at = seq(0, 0.4, by = 0.2), seq(0, 0.4, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
abline(h = sigma_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(sigma), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Poolsize", side = 1, line = 3, las = 1, cex = 1.5)
pdf(paste0("Uncertainty_10.pdf"), width = 10, height = 6)
par(mfrow = c(2, 2), oma = c(2, 1, 2, 1), mar = c(4, 5, 3, 0), mgp = c(3, 1, 0),
bty = "n")
EnvStats::errorBar(x = 5:15, y = p_all_3[ 2,], lower = p_all_3[1,], upper = p_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
ylim = c(0, 1), yaxt = "n", xaxt = "n", cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(0, 1, by = 0.2), seq(0, 1, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = p_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(p), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Pool size", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = mu1_all_3[ 2,], lower = mu1_all_3[ 1,], upper = mu1_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 3), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(0, 3, by = 1), seq(0, 3, by = 1), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[1]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Pool size", side = 1, line = 3, las = 1, cex = 1.5)
legend(x = 10, y = 4.5, legend = "true value", lw = 2, lty = 2, col = "#FF7F00",
bty = "n", xpd = NA, cex = 1.3)
EnvStats::errorBar(x = 5:15, y = mu2_all_3[ 2,], lower = mu2_all_3[1,], upper = mu2_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(-2.5,1.5), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(-2, 1, by = 1), seq(-2, 1, by = 1), cex.axis = 1.3,
tick = TRUE, las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[2], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[2]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Pool size", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = sigma_all_3[ 2,], lower = sigma_all_3[1,], upper = sigma_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 0.4), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
axis(side = 2, at = seq(0, 0.4, by = 0.2), seq(0, 0.4, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
abline(h = sigma_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(sigma), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Pool size", side = 1, line = 3, las = 1, cex = 1.5)
dev.off()
pdf(paste0("Uncertainty_10.pdf"), width = 10, height = 6)
par(mfrow = c(2, 2), oma = c(2, 1, 2, 1), mar = c(4, 5, 3, 0), mgp = c(3, 1, 0),
bty = "n")
EnvStats::errorBar(x = 5:15, y = p_all_3[ 2,], lower = p_all_3[1,], upper = p_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
ylim = c(0, 1), yaxt = "n", xaxt = "n", cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(0, 1, by = 0.2), seq(0, 1, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = p_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(p), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Pool size", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = mu1_all_3[ 2,], lower = mu1_all_3[ 1,], upper = mu1_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 3), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(0, 3, by = 1), seq(0, 3, by = 1), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[1]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Pool size", side = 1, line = 3, las = 1, cex = 1.5)
legend(x = 10, y = 4.5, legend = "true value", lw = 2, lty = 2, col = "#FF7F00",
bty = "n", xpd = NA, cex = 1.3)
EnvStats::errorBar(x = 5:15, y = mu2_all_3[ 2,], lower = mu2_all_3[1,], upper = mu2_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(-2.5,1.5), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(-2, 1, by = 1), seq(-2, 1, by = 1), cex.axis = 1.3,
tick = TRUE, las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[2], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[2]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Pool size", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = sigma_all_3[ 2,], lower = sigma_all_3[1,], upper = sigma_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 0.4), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
axis(side = 2, at = seq(0, 0.4, by = 0.2), seq(0, 0.4, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
abline(h = sigma_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(sigma), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Pool size", side = 1, line = 3, las = 1, cex = 1.5)
dev.off()
EnvStats::errorBar(x = 5:15, y = mu1_all_3[ 2,], lower = mu1_all_3[ 1,], upper = mu1_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 3), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(0, 3, by = 1), seq(0, 3, by = 1), cex.axis = 1.3, tick = TRUE,
las = 1)
pdf(paste0("Uncertainty_10.pdf"), width = 10, height = 6)
par(mfrow = c(2, 2), oma = c(2, 1, 2, 1), mar = c(4, 5, 3, 0), mgp = c(3, 1, 0),
bty = "n")
EnvStats::errorBar(x = 5:15, y = p_all_3[ 2,], lower = p_all_3[1,], upper = p_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
ylim = c(0, 1), yaxt = "n", xaxt = "n", cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(0, 1, by = 0.2), seq(0, 1, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = p_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(p), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Pool size", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = mu1_all_3[ 2,], lower = mu1_all_3[ 1,], upper = mu1_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(1, 3), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(1, 3, by = 1), seq(1, 3, by = 1), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[1]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Pool size", side = 1, line = 3, las = 1, cex = 1.5)
legend(x = 10, y = 4.5, legend = "true value", lw = 2, lty = 2, col = "#FF7F00",
bty = "n", xpd = NA, cex = 1.3)
EnvStats::errorBar(x = 5:15, y = mu2_all_3[ 2,], lower = mu2_all_3[1,], upper = mu2_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(-2.5,1.5), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(-2, 1, by = 1), seq(-2, 1, by = 1), cex.axis = 1.3,
tick = TRUE, las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[2], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[2]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Pool size", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = sigma_all_3[ 2,], lower = sigma_all_3[1,], upper = sigma_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 0.4), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
axis(side = 2, at = seq(0, 0.4, by = 0.2), seq(0, 0.4, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
abline(h = sigma_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(sigma), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Pool size", side = 1, line = 3, las = 1, cex = 1.5)
dev.off()
pdf(paste0("Uncertainty_10.pdf"), width = 10, height = 6)
par(mfrow = c(2, 2), oma = c(2, 1, 2, 1), mar = c(4, 5, 3, 0), mgp = c(3, 1, 0),
bty = "n")
EnvStats::errorBar(x = 5:15, y = p_all_3[ 2,], lower = p_all_3[1,], upper = p_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
ylim = c(0, 1), yaxt = "n", xaxt = "n", cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(0, 1, by = 0.2), seq(0, 1, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = p_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(p), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Pool size", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = mu1_all_3[ 2,], lower = mu1_all_3[ 1,], upper = mu1_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(1, 3), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(1, 3, by = 1), seq(1, 3, by = 1), cex.axis = 1.3, tick = TRUE,
las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[1]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Pool size", side = 1, line = 3, las = 1, cex = 1.5)
legend(x = 10, y = 3.5, legend = "true value", lw = 2, lty = 2, col = "#FF7F00",
bty = "n", xpd = NA, cex = 1.3)
EnvStats::errorBar(x = 5:15, y = mu2_all_3[ 2,], lower = mu2_all_3[1,], upper = mu2_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(-2.5,1.5), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 2, at = seq(-2, 1, by = 1), seq(-2, 1, by = 1), cex.axis = 1.3,
tick = TRUE, las = 1)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
abline(h = mu_true[2], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(mu[2]), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Pool size", side = 1, line = 3, las = 1, cex = 1.5)
EnvStats::errorBar(x = 5:15, y = sigma_all_3[ 2,], lower = sigma_all_3[1,], upper = sigma_all_3[
3,], incr = FALSE, gap = FALSE, bar.ends.size = 0.2, pch = 19, xlab = "", ylab = "",
yaxt = "n", xaxt = "n", ylim = c(0, 0.4), cex.axis = 1.3, cex.lab = 1.7)
axis(side = 1, at = 5:15, 5:15, cex.axis = 1.3, tick = TRUE)
axis(side = 2, at = seq(0, 0.4, by = 0.2), seq(0, 0.4, by = 0.2), cex.axis = 1.3, tick = TRUE,
las = 1)
abline(h = sigma_true[1], lw = 2, lty = 2, col = "#FF7F00")
mtext(expression(sigma), side = 2, line = 3, las = 1, cex = 1.5)
mtext("Pool size", side = 1, line = 3, las = 1, cex = 1.5)
dev.off()
hist(OVL_D_1_all,breaks = 100, col = c(rep("grey",sum(hist_D_1$breaks<OVL_D_1_95)), rep("black",sum(hist_D_1$breaks>=OVL_D_1_95))), border = c(rep("grey",sum(hist_D_1$breaks<OVL_D_1_95)), rep("black",sum(hist_D_1$breaks>=OVL_D_1_95))),
, xlab = "Overlap", main ="60 and 200 single-cells")
lines(x=rep(OVL_D,2), y=c(0,1000), col = "#FF7F00", lwd= 3)
pdf("Overlap_D.pdf",  width = 12, height = 3)
par(mfrow=c(1,2))
hist(OVL_D_1_all,breaks = 100, col = c(rep("grey",sum(hist_D_1$breaks<OVL_D_1_95)), rep("black",sum(hist_D_1$breaks>=OVL_D_1_95))), border = c(rep("grey",sum(hist_D_1$breaks<OVL_D_1_95)), rep("black",sum(hist_D_1$breaks>=OVL_D_1_95))),
xlab = "Overlap", main ="60 and 200 single-cells")
lines(x=rep(OVL_D,2), y=c(0,1000), col = "#89BBBF", lwd= 3)
dev.off()
